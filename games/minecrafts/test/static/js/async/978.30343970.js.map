{"version":3,"file":"static/js/async/978.30343970.js","sources":["webpack://minecraft-web-client/./src/react/prosemirror-markdown.ts"],"sourcesContent":["import { EditorView } from 'prosemirror-view'\nimport { EditorState } from 'prosemirror-state'\nimport { schema, defaultMarkdownParser, defaultMarkdownSerializer } from 'prosemirror-markdown'\nimport { exampleSetup, buildMenuItems } from 'prosemirror-example-setup'\nimport { MarkSpec } from 'prosemirror-model'\nimport { toggleMark } from 'prosemirror-commands'\n\nexport class ProseMirrorView {\n  view\n\n  constructor (target, content) {\n    console.log('schema.marks', schema.marks)\n    //@ts-expect-error\n    schema.marks.textColor = {\n      spec: {\n        attrs: { color: {} },\n        inline: true,\n        parseDOM: [\n          {\n            style: 'color',\n            getAttrs: value => ({ color: value })\n          }\n        ],\n        toDOM: mark => ['span', { style: `color: ${mark.attrs.color}` }, 0]\n      },\n    }\n\n    const fullMenu = buildMenuItems(schema).fullMenu as Array<Array<import('prosemirror-menu').MenuItem>>\n    fullMenu[0] = fullMenu[0].filter(item => item.spec.title !== 'Add or remove link' && item.spec.title !== 'Toggle code font')\n    fullMenu.splice(3, 1); // remove the insert list, quote & checkbox menu\n    (fullMenu[1][0] as any).options.label = 'Color' // check-build error: fullMenu[1][0].options.label = 'Color'\n    // fullMenu[1][0].content[0].spec.label = 'Red'\n    // fullMenu[1][0].content[0].spec.run = (state, dispatch, view) => {\n    // console.log('state', state)\n    // // make <p style=\"color: red\">...</p>\n    // const { from, to } = state.selection\n    // const { tr } = state\n    // console.log(schema.marks)\n    // tr.addMark(from, to, schema.marks.textColor.create({ color: 'red' }))\n    // dispatch(tr)\n    //   toggleMark(schema.marks.textColor, { color: 'red' })(state, dispatch, view)\n    // }\n    fullMenu[1].splice(1, 1) // remove the type menu\n    console.log('fullMenu', fullMenu)\n    this.view = new EditorView(target, {\n      state: EditorState.create({\n        doc: defaultMarkdownParser.parse(content) ?? undefined,\n        plugins: exampleSetup({\n          schema,\n          menuContent: fullMenu,\n        }),\n      }),\n      attributes (state) {\n        return {\n          autocorrect: 'off',\n          autocapitalize: 'off',\n          spellcheck: 'false',\n          autofocus: 'true',\n        }\n      },\n    })\n  }\n\n  get content () {\n    const content = defaultMarkdownSerializer.serialize(this.view.state.doc)\n    console.log('content', content)\n    return content\n  }\n\n  focus () {\n    this.view.focus()\n  }\n\n  destroy () {\n    this.view.destroy()\n  }\n}\n"],"names":["ProseMirrorView","target","content","console","schema","value","mark","_defaultMarkdownParser_parse","fullMenu","buildMenuItems","item","EditorView","EditorState","undefined","exampleSetup","state","focus","destroy","defaultMarkdownSerializer"],"mappings":"gTAOaA,EAAN,W,SAAMA,gBAGEC,CAAM,CAAEC,CAAO,E,aAHjBF,iBAITG,QAAQ,GAAG,CAAC,eAAgBC,EAAAA,EAAAA,CAAAA,KAAY,EAExCA,EAAAA,EAAAA,CAAAA,KAAAA,CAAAA,SAAsB,CAAG,CACvB,KAAM,CACJ,MAAO,CAAE,MAAO,CAAC,CAAE,EACnB,OAAQ,GACR,SAAU,CACR,CACE,MAAO,QACP,SAAUC,SAAAA,CAAK,E,MAAK,CAAE,MAAOA,CAAM,C,CACrC,EACD,CACD,MAAOC,SAAAA,CAAI,E,MAAI,CAAC,OAAQ,CAAE,MAAQ,UAA0B,OAAjBA,EAAK,KAAK,CAAC,KAAK,CAAG,EAAG,EAAE,A,CACrE,CACF,EAEA,IAmBSC,EAnBHC,EAAWC,AAAAA,GAAAA,EAAAA,EAAAA,AAAAA,EAAeL,EAAAA,EAAMA,EAAE,QAAQ,AAChDI,CAAAA,CAAQ,CAAC,EAAE,CAAGA,CAAQ,CAAC,EAAE,CAAC,MAAM,CAACE,SAAAA,CAAI,E,MAAIA,AAAoB,uBAApBA,EAAK,IAAI,CAAC,KAAK,EAA6BA,AAAoB,qBAApBA,EAAK,IAAI,CAAC,KAAK,A,GACpGF,EAAS,MAAM,CAAC,EAAG,GAClBA,CAAQ,CAAC,EAAE,CAAC,EAAE,CAAS,OAAO,CAAC,KAAK,CAAG,QAYxCA,CAAQ,CAAC,EAAE,CAAC,MAAM,CAAC,EAAG,GACtBL,QAAQ,GAAG,CAAC,WAAYK,GACxB,IAAI,CAAC,IAAI,CAAG,IAAIG,EAAAA,EAAUA,CAACV,EAAQ,CACjC,MAAOW,EAAAA,EAAAA,CAAAA,MAAkB,CAAC,CACxB,IAAKL,MAAAA,CAAAA,EAAAA,EAAAA,EAAAA,CAAAA,KAA2B,CAACL,EAAO,EAAnCK,EAAwCM,KAAAA,EAC7C,QAASC,AAAAA,GAAAA,EAAAA,EAAAA,AAAAA,EAAa,CACpBV,OAAAA,EAAAA,EAAMA,CACN,YAAaI,CACf,EACF,GACA,oBAAYO,CAAK,EACf,MAAO,CACL,YAAa,MACb,eAAgB,MAChB,WAAY,QACZ,UAAW,MACb,CACF,CACF,E,OArDSf,gBAAAA,SAAAA,C,OA8DXgB,EAAAA,KAEC,CAFDA,WACE,IAAI,CAAC,IAAI,CAAC,KAAK,EACjB,EAEAC,EAAAA,OAEC,CAFDA,WACE,IAAI,CAAC,IAAI,CAAC,OAAO,EACnB,E,QApEWjB,gBAAAA,C,CAwDP,c,IAAJ,WACE,IAAME,EAAUgB,EAAAA,EAAAA,CAAAA,SAAmC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAEvE,OADAf,QAAQ,GAAG,CAAC,UAAWD,GAChBA,CACT,C,IA5DWF,e"}